# =============================================================================
# Recipe Scraper Service - Environment Configuration
# =============================================================================
# Copy this file to .env and update values for your environment.
# NEVER commit .env files to version control!

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# Environment: development, staging, production
APP_ENV=development

# Debug mode (only enable in development)
DEBUG=true

# Application metadata
PROJECT_NAME="Recipe Scraper Service"
PROJECT_DESCRIPTION="Enterprise-grade FastAPI recipe scraping service"
VERSION=0.1.0

# API settings
API_V1_PREFIX=/api/v1

# Show API documentation (disable in production if needed)
SHOW_DOCS=true

# -----------------------------------------------------------------------------
# Server Settings
# -----------------------------------------------------------------------------
HOST=0.0.0.0
PORT=8000
WORKERS=1
RELOAD=true

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# Secret key for JWT and session encryption
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=change-me-in-production-use-secrets-token-urlsafe-32

# JWT settings
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# -----------------------------------------------------------------------------
# Authentication Provider
# -----------------------------------------------------------------------------
# Auth mode determines how tokens are validated:
#   - introspection: Validate via external auth-service (production)
#   - local_jwt: Validate JWTs locally using shared secret (distributed/offline)
#   - header: Extract user from X-User-ID header (testing/development only)
#   - disabled: No authentication required
AUTH_MODE=local_jwt

# External auth service settings (required for introspection mode)
# Base URL of the auth service API
AUTH_SERVICE_URL=
# OAuth2 client credentials for this service (used for token introspection)
AUTH_SERVICE_CLIENT_ID=recipe-scraper-service
AUTH_SERVICE_CLIENT_SECRET=

# Token introspection settings
# How long to cache introspection results (seconds)
AUTH_INTROSPECTION_CACHE_TTL=60
# HTTP timeout for introspection calls (seconds)
AUTH_INTROSPECTION_TIMEOUT=5.0
# Fall back to local JWT validation if introspection fails
AUTH_INTROSPECTION_FALLBACK_LOCAL=false

# Header-based auth settings (for testing/development only)
# These headers are used when AUTH_MODE=header
AUTH_HEADER_USER_ID=X-User-ID
AUTH_HEADER_ROLES=X-User-Roles
AUTH_HEADER_PERMISSIONS=X-User-Permissions

# JWT validation settings (for local_jwt mode and introspection fallback)
# Expected issuer claim (leave empty to skip issuer validation)
AUTH_JWT_ISSUER=
# Expected audience claims (comma-separated, leave empty to skip validation)
AUTH_JWT_AUDIENCE=

# -----------------------------------------------------------------------------
# Redis (shared settings for cache, queue, and rate limiting)
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# Database numbers for different purposes
REDIS_CACHE_DB=0
REDIS_QUEUE_DB=1
REDIS_RATE_LIMIT_DB=2

# Client-side cache TTL (seconds)
CLIENT_CACHE_MAX_AGE=30

# Rate limits (requests/period)
RATE_LIMIT_DEFAULT=100/minute
RATE_LIMIT_AUTH=5/minute

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=DEBUG

# Log format: json, text
LOG_FORMAT=text

# -----------------------------------------------------------------------------
# Observability
# -----------------------------------------------------------------------------
# OpenTelemetry OTLP endpoint (leave empty to disable tracing)
OTLP_ENDPOINT=

# Enable distributed tracing
ENABLE_TRACING=true

# Enable Prometheus metrics
METRICS_ENABLED=true

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
FEATURE_FLAGS_ENABLED=true
